{% extends 'index-blank.html' %}
{% load crispy_forms_tags %}
{% block content %}   
<div class="br-mainpanel" style="position: relative;">
 
  <div class="br-pageheader pd-y-15 pd-md-l-20">
    <nav class="breadcrumb pd-0 mg-0 tx-12">
      <a class="breadcrumb-item"> {{proyecto}}</a>
      <a class="breadcrumb-item" href="{% url 'Bandejaeys' %}">Bandeja Entrada y Salida</a>      
      <span class="breadcrumb-item active">Bandeja Entradas </span>
    </nav>
  </div><!-- br-pageheader -->
<!--Fin Filtros-->
  <div class="pd-10 bg-gray-900 rounded">
              <ul class="nav nav-pills nav-pills-for-dark flex-column flex-md-row" style="margin-left:auto;margin-right:auto;"role="tablist">
              {% if request.user.perfil.rol_usuario == 3 or request.user.perfil.rol_usuario == 6 %}
              
              {% else %}
              <li class="nav-item"><a href="{% url 'paquete-preview' %}" class="btn btn-warning bd-0 btn-compose" role="tab">Nuevo Transmittal</a></li>

              {% endif %}
                <li class="nav-item"><a href="{% url 'Bandejaeys' %}" class="nav-link active mg-l-15"><i class="icon fa fa-reply"></i> Recibidos</a></li>
                <li class="nav-item"><a href="{% url 'bandeja-enviados' %}" class="nav-link mg-l-15"><i class="icon fa fa-share"></i> Enviados</a></li>
                <li class="nav-item"><a href="{% url 'Borradores' %}" class="nav-link mg-l-15"><i class="icon icon ion-edit"></i> Borradores</a></li>
              </ul>
  </div>
  <div class="pd-x-20 pd-sm-x-30 pd-t-20 pd-sm-t-30">
    <h4 class="tx-gray-800 mg-b-5">Bandeja de entrada</h4>
  </div>

  <div class="br-pagebody pd-x-30 pd-sm-x-40">
    <div class="card bd-0 shadow-base dataTables_wrapper no-footer " style="padding:20px;"id="mydatatable-container">
      <table class="records_list table table-striped table-bordered table-hover table-primary" id="mydatatable" role="grid" aria-describedby="datatable2_info">
        <thead>
          <tr role="row" style="color:#fff;"> 
            <th class="tx-10-force tx-mont tx-medium hidden-xs-down"tabindex="0" aria-controls="datatable2" rowspan="1" colspan="1"  style="vertical-align:center;text-align:center;color:#fff;">Transmittal</th>
            <th class="tx-10-force tx-mont tx-medium hidden-xs-down"tabindex="0" aria-controls="datatable2" rowspan="1" colspan="1"  style="vertical-align:center;text-align:center;color:#fff;">Asunto</th>
            <th class="tx-10-force tx-mont tx-medium hidden-xs-down"tabindex="0" aria-controls="datatable2" rowspan="1" colspan="1"  style="vertical-align:center;text-align:center;color:#fff;">Emisor</th>
            <th class="tx-10-force tx-mont tx-medium hidden-xs-down"tabindex="0" aria-controls="datatable2" rowspan="1" colspan="1"  style="vertical-align:center;text-align:center;color:#fff;">Destinatario</th>
            <th class="tx-10-force tx-mont tx-medium hidden-xs-down sorting_asc"tabindex="0" aria-controls="datatable2" rowspan="1" colspan="1"  style="vertical-align:center;text-align:center;color:#fff;">Fecha</th>
            <th class="tx-10-force tx-mont tx-medium hidden-xs-down sorting_asc"tabindex="0" aria-controls="datatable2" rowspan="1" colspan="1"  style="vertical-align:center;text-align:center;color:#fff;">Hora</th>
            <th class="tx-10-force tx-mont tx-medium hidden-xs-down"tabindex="0" aria-controls="datatable2" rowspan="1" colspan="1"  style="vertical-align:center;text-align:center;color:#fff;">Detalle</th>
          </tr>
        </thead>
        <tbody>
        {% for paquete in paquetes %}
          <tr role="row" class="odd">
            <td class="valign-middle hidden-xs-down"tabindex="0" class="sorting_1"style="vertical-align:center;text-align:center;">
                  <a href="{% url 'paquete-detalle' paquete.pk %}">
                  {{paquete.codigo}}</a>
            </td>            
            <td class="valign-middle hidden-xs-down"style="vertical-align:center;text-align:center;"> {{ paquete.asunto }} </td>           
            <td class="valign-middle hidden-xs-down"style="vertical-align:center;text-align:center;"> {{ paquete.owner }}</td>
            <td class="valign-middle hidden-xs-down"style="vertical-align:center;text-align:center;"> {{ paquete.destinatario }}</td>
            <td class="valign-middle hidden-xs-down"style="vertical-align:center;text-align:center;">{{ paquete.fecha_creacion|date:'d-M-y'}}</td>
            <td class="valign-middle hidden-xs-down"style="vertical-align:center;text-align:center;">{{paquete.fecha_creacion|date:'H:i'}}</td>
            <td class="valign-middle hidden-xs-down"style="vertical-align:center;text-align:center;">
              <a class="btn btn-teal"href="{% url 'paquete-detalle' paquete.pk %}"><i class="icon ion-eye"></i></a>       
            </td>
          </tr>
          
          {% empty %}

          <div class="modal fade in" id="myModal" role="dialog" style="display: block; padding-right: 16px;">
            <div class="modal-dialog" role="document">
              <div class="modal-content tx-size-sm">
                <div class="modal-body tx-center pd-y-20 pd-x-20">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <i class="icon icon ion-ios-close-outline tx-100 tx-danger lh-1 mg-t-20 d-inline-block"></i>
                  <h4 class="tx-danger  tx-semibold mg-b-20">Error: No hay Información Ingresada!</h4>
                  <button type="button" class="btn btn-danger tx-11 tx-uppercase pd-y-12 pd-x-25 tx-mont tx-medium mg-b-20" data-dismiss="modal" aria-label="Close">
                    Continue</button>
                  </div><!-- modal-body -->
                </div><!-- modal-content -->
              </div><!-- modal-dialog -->
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" type="text/javascript"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>
        <script type="text/javascript">
         $(function(){
          $("#myModal").modal();
         });
        </script>

          {% endfor %}
      </table>    
    </div>
  </div><!-- br-pagebody -->  
</div><!-- br-contentpanel -->
 
<!--Script-->
<script>
  $(function(){
    'use strict';

    // show only the icons and hide left menu label by default
    $('.menu-item-label,.menu-item-arrow').addClass('op-lg-0-force d-lg-none');

    $(document).on('mouseover', function(e){
      e.stopPropagation();
      if($('body').hasClass('collapsed-menu')) {
        var targ = $(e.target).closest('.br-sideleft').length;
        if(targ) {
          $('body').addClass('expand-menu');

          // show current shown sub menu that was hidden from collapsed
          $('.show-sub + .br-menu-sub').slideDown();

          var menuText = $('.menu-item-label,.menu-item-arrow');
          menuText.removeClass('d-lg-none');
          menuText.removeClass('op-lg-0-force');

        } else {
          $('body').removeClass('expand-menu');

          // hide current shown menu
          $('.show-sub + .br-menu-sub').slideUp();

          var menuText = $('.menu-item-label,.menu-item-arrow');
          menuText.addClass('op-lg-0-force');
          menuText.addClass('d-lg-none');
        }
      }
    });

    // Showing sub left menu
    $('#showSubLeft').on('click', function(){
      if($('body').hasClass('show-subleft')) {
        $('body').removeClass('show-subleft');
      } else {
        $('body').addClass('show-subleft');
      }
    });

  });
</script>

<script>
  $(document).ready(function() {
      $('#mydatatable').DataTable(
        {
          "dom": 'B<"float-right"f>t<"float-left"l>p<"clearfix">',
          "responsive": true,
          "bSort": false,
           "oLanguage": {
              "sSearch": "&#128270;" //search
            },
          "language": {
          "url": "https://cdn.datatables.net/plug-ins/1.10.19/i18n/Spanish.json"
          },
          "order":[[4,"desc"]],
          buttons:{
            dom: {
                button: {
                    className: 'btn btn-success'
                }
            },
          },
          buttons:[ 
            {
                //definimos estilos del boton de excel
                extend: "excelHtml5",
                text:'Exportar a Excel',
                className:'btn btn-success',

                // 1 - ejemplo básico - uso de templates pre-definidos
                //definimos los parametros al exportar a excel
              customize: function( xlsx ) {
                var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
                $('row c[r^="C"]', sheet).attr( 's', '2' );
            },
                 excelStyles: {               // Apply the 'header_blue' template part (white font on a blue background in the header/footer)
                    template:"blue_medium",
                    
                    
                },

            }]	     
        });
  } );
</script>
{% endblock content %}