{% extends "index-popup.html" %}

{% load static %}

{% load crispy_forms_tags %}

{% block content %}
{% if form.errors %}
    {% for field in form %}
        {% for error in field.errors %}
        <div class="alert alert-danger" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="d-flex align-items-center justify-content-start">
                <i class="icon ion-ios-checkmark alert-icon tx-32 mg-t-5 mg-xs-t-0"></i>
                <span><strong>Error!</strong> {{ error|escape }}.</span>
            </div><!-- d-flex -->
            </div><!-- alert -->
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <div class="alert alert-danger" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="d-flex align-items-center justify-content-start">
                <i class="icon ion-ios-checkmark alert-icon tx-32 mg-t-5 mg-xs-t-0"></i>
                <span><strong>Error!</strong> {{ error|escape }}.</span>
            </div><!-- d-flex -->
            </div><!-- alert -->
    {% endfor %}
{% endif %}
    <form method="POST" name="form" enctype="multipart/form-data" id="verion_form" class="form-group mg-t-20">{% csrf_token %}
       <div class="card bd-0 shadow-base">
        <div class="br-section-wrapper col-md-12">
            {{ form.prev_documento_fk|as_crispy_field}}
            {{ form.prev_revision|as_crispy_field}}
            
                {% if request.user.perfil.rol_usuario >= 4 and request.user.perfil.rol_usuario < 6  %}
                     {{ form.prev_estado_contratista|as_crispy_field}}                    
                
                {% elif request.user.perfil.rol_usuario >= 1 and request.user.perfil.rol_usuario < 3 %}
                    {{ form.prev_estado_cliente|as_crispy_field}}                    
                {% endif %}       
                <div style="padding-left:35px;">  
                {{ form.adjuntar|as_crispy_field}}
                </div>
            {{ form.prev_archivo|as_crispy_field}}
             <button name="submit" type="submit" class="btn btn-warning" ><span class="glyphicon glyphicon-send"></span>Subir</button>
        
        </div>
       
    </div>
    </form>

<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>


<script>
$(document).ready(function() {
    $('.select2').select2({
    language: "es",
    placeholder: 'Seleccione',
    ajax: {
        url: "{% url 'datos-baes'%}",
        dataType: 'json',
          processResults: function (data) {
                    return {
                        results: $.map(data, function (item) {
                            return {id: item.id, text: item.Codigo_documento};
                        })
                    };
                }
            }
       });
});
</script> 

<script
  src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
  integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
  crossorigin="anonymous">
</script>
<script>
function detectStatus(){
    $.getJSON("{% url 'popup-version' paquete_pk %}",
        function(data){
            console.log("{% url 'popup-version' paquete_pk %}")
            if (data.status == 1){
                alert('YESSS, YESSSSSS')
            }
        }
    )
}
</script>

<script type="text/javascript">
    function disableSending() {
    document.form.prev_archivo.disabled = !document.form.adjuntar.checked;
    };
</script>

{% endblock content %}
