{% extends 'index-blank.html' %}

{% load static %}

{% load crispy_forms_tags %}

{% block content %}
 <div class="pd-10 bg-gray-900 rounded">
            <ul class="nav nav-pills nav-pills-for-dark flex-column flex-md-row" style="margin-left:auto;margin-right:auto;"role="tablist">
              <li class="nav-item"><a href="{% url 'paquete-preview' %}" class="btn btn-warning bd-0 btn-compose" role="tab">Nuevo Transmittal</a></li>
              <li class="nav-item"><a href="{% url 'Bandejaeys' %}" class="nav-link mg-l-15"><i class="icon fa fa-reply"></i> Recibidos</a></li>
              <li class="nav-item"><a href="{% url 'bandeja-enviados' %}" class="nav-link mg-l-15"><i class="icon fa fa-share"></i> Enviados</a></li>
              <li class="nav-item"><a href="{% url 'Borradores' %}" class="nav-link mg-l-15"><i class="icon icon ion-edit"></i> Borradores</a></li>
            </ul>
          </div>

<div class="br-pagebody pd-x-20 pd-sm-x-30">
    <div class="card bd-0 shadow-base">
        <div class="br-section-wrapper">
         <form method="post" class="form-group mg-t-20" id="form_paquete" >{% csrf_token %}

                <div id="wizard2" role="application" class="wizard clearfix">
                        <div class="steps clearfix">
                            <ul role="tablist">
                            <li role="tab"  class="disabled" aria-disabled="false" aria-selected="true">
                                <a id="wizard2-t-0" href="#wizard2-h-0" aria-controls="wizard2-p-0">
                                    <span class="current-info audible">Paso: </span>
                                    <span class="number">1</span> 
                                    <span class="title">Configurar Destinatarios</span>
                                </a>
                            </li>
                            <li role="tab"class="first current" aria-disabled="true">
                                    <a id="wizard2-t-1" href="#wizard2-h-1" aria-controls="wizard2-p-1">
                                        <span class="number">2</span> 
                                        <span class="title">Adjuntar Archivos</span>
                                    </a>
                                </li>        
                            </ul>            
                        </div>
                          <div class="content clearfix">
                            <h3 id="wizard2-h-0" tabindex="-1" class="title current">Tabla de adjuntos</h3>
                            <section id="wizard2-p-0" role="tabpanel" aria-labelledby="wizard2-h-0" class="body current" aria-hidden="false">
                            <h3 class="title current">Versiones adjuntadas</h3>

                              <div id="tablaVersiones">
                                  <table class="table table-responsive table-striped mg-b-0 table-bordered table-primary" style="width:100%;">
                                      <thead>
                                          <tr>
                                              <th class="tx-10-force tx-mont tx-medium hidden-xs-down"style="text-align: center; color: white;"> Documento </th>
                                              <th class="tx-10-force tx-mont tx-medium hidden-xs-down"style="text-align: center; color: white;"> Nombre </th>
                                              <th class="tx-10-force tx-mont tx-medium hidden-xs-down"style="text-align: center; color: white;"> Especialidad </th>
                                              <th class="tx-10-force tx-mont tx-medium hidden-xs-down"style="text-align: center; color: white;"> Revisi칩n </th>
                                               {% if request.user.perfil.rol_usuario >= 4 and request.user.perfil.rol_usuario < 6  %}                                                       
                                              <th class="tx-10-force tx-mont tx-medium hidden-xs-down"style="text-align: center; color: white;"> Estado Contratista </th>
                                                    
                                               {% elif request.user.perfil.rol_usuario >= 1 and request.user.perfil.rol_usuario < 3 %}
                                              <th class="tx-10-force tx-mont tx-medium hidden-xs-down"style="text-align: center; color: white;"> Estado Cliente </th>                  
                                               {% endif %}  
                                              
                                              <th class="tx-10-force tx-mont tx-medium hidden-xs-down"style="text-align: center; color: white;"></th>
                                              <th class="tx-10-force tx-mont tx-medium hidden-xs-down"style="text-align: center; color: white;"></th>


                                          </tr>
                                      </thead>
                                        <tbody>
                                        {% for version in versiones %}
                                            <tr>
                                              <td style="text-align: center;border: 2px;border-color: grey; color: black;" > {{version.prev_documento_fk}} </td>
                                              <td style="text-align: center;border: 2px;border-color: grey; color: black;" > {{version.prev_documento_fk.Descripcion}} </td>
                                              <td style="text-align: center;border: 2px;border-color: grey; color: black;" > {{version.prev_documento_fk.Especialidad}} </td>
                                              <td style="text-align: center;border: 2px;border-color: grey; color: black;"> {{version.get_prev_revision_display}} </td>
                                               {% if request.user.perfil.rol_usuario >= 4 and request.user.perfil.rol_usuario < 6  %}                                                       
                                              <td style="text-align: center;border: 2px;border-color: grey; color: black;"> {{version.get_prev_estado_contratista_display}} </td>
                                                    
                                                   
                                               {% elif request.user.perfil.rol_usuario >= 1 and request.user.perfil.rol_usuario < 3 %}
                                                      <td style="text-align: center;border: 2px;border-color: grey; color: black;"> {{version.get_prev_estado_cliente_display}} </td>
                                                   
                                               {% endif %}  
                                              <td style="text-align: center;border: 2px;border-color: grey; color: black;"> <a onclick="JavaScript:window.open('{% url 'popup-version-update' version.pk paquete_pk %}','subir datos','toolbar=no,status=no,scrollbars=no,location=no,menubar=no,directories=no,resizable=yes,width=450,height=620,top=100,left=600');"><i class="fa fa-pencil"></i></a> </td>
                                              <td style="text-align: center;border: 2px;border-color: grey; color: black;"> <a href="{% url 'delete-prev-version' version.pk paquete_pk %}" onclick="confirm('Est치s por eliminar esta versi칩n. Est치s seguro ?')"><i class="icon ion-trash-a"></i></a></td>

                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                              </div>
                              <input type="submit" class="btn btn-teal mg-t-30 mg-b-30 float-left" value="Enviar"/>
                              <a href="{% url 'borrador-crear' paquete_pk %}"><button type="button" class="btn btn-primary mg-t-30 mg-l-20 mg-b-30 float-left"><i class="icon ion-bookmark mg-r-2"></i> Guardar en Borrador</button></a>
                              <a class="btn btn-warning mg-t-30 mg-l-20 mg-b-30 float-left" type="button" onclick="JavaScript:window.open('{% url 'popup-version' paquete_pk %}','subir datos','toolbar=no,status=no,scrollbars=no,location=no,menubar=no,directories=no,resizable=yes,width=450,height=620,top=100,left=600');"><i class="icon ion-plus mg-r-2"></i> Agregar Archivo</a>
                </div>
                
            </form>
        </div>
    </div>     

</div>
  
  </div>

<script language='javascript'>
var t;
function doLoad() {
t = setTimeout("window.close()",1000);
}

</script>
<script type="text/javascript">
function refreshAndClose() {
    window.opener.location.reload(true);
    window.close();
}
</script>
<script>
    window.onunload = refreshParent;
    function refreshParent() {
      window.opener.location.reload();
    }
</script>

{% endblock content %}